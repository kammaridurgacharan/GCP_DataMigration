import osfrom google.cloud import storagefrom google.oauth2 import service_accountimport mysql.connector# Database credentialsDB_NAME = 'db_name'DB_USER = 'user'DB_PASS = 'password'DB_HOST = 'host'# GCP credentials and bucket detailsSERVICE_ACCOUNT_FILE = 'Path_to_serviceaccount_key'BUCKET_NAME = 'bucket_name'FOLDER_NAME = 'folder_name'# Initialize GCP storage client and get bucketcreds = service_account.Credentials.from_service_account_file(SERVICE_ACCOUNT_FILE)storage_client = storage.Client(credentials=creds)bucket = storage_client.get_bucket(BUCKET_NAME)# Create a connection to the MySQL databasecnx = mysql.connector.connect(user=DB_USER, password=DB_PASS, host=DB_HOST, database=DB_NAME)# Create cursorcursor = cnx.cursor()# Select data from the three tables and save to filesfor table in ['table1', 'table2', 'table3']:    file_path = f'{table}.csv'    with open(file_path, 'w') as file:        cursor.execute(f'SELECT * FROM {table}')        rows = cursor.fetchall()        for row in rows:            file.write(','.join([str(col) for col in row]) + '\n')        # Upload file to GCP bucket    blob = bucket.blob(FOLDER_NAME + file_path)    blob.upload_from_filename(file_path)    os.remove(file_path)# Close cursor and connection to databasecursor.close()cnx.close()print("Hello, MySQL database migrated to GCP bucket successfully!")